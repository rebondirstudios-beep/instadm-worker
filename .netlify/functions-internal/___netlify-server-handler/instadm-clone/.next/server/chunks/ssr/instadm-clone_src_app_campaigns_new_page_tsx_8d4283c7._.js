module.exports=[27421,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(63588),f=a.i(210),g=a.i(14548),h=a.i(25015),i=a.i(81560),j=a.i(38246);function k(){let a=(0,d.useRouter)(),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)({name:"",messageTemplateId:"",leadsUrl:"",schedule:{type:"immediate",startDate:"",endDate:"",dailyLimits:{startHour:"9",endHour:"21",messagesPerHour:"10",messagesPerDay:"100"}},settings:{delayBetweenMessages:"30",useSpinText:!1,randomizeMessageOrder:!1,skipAlreadyContacted:!0,enableFollowUp:!1,followUpDelay:"24",followUpMessage:"",leadUsernames:[]}}),[s,t]=(0,c.useState)([]);(0,c.useEffect)(()=>{let a=!1;return(async()=>{try{let b=await fetch("/api/templates"),c=await b.json().catch(()=>({}));if(!b.ok)throw Error(c?.error||`Failed to load templates (HTTP ${b.status})`);if(a)return;t(Array.isArray(c?.templates)?c.templates:[])}catch(b){a||window.alert(b?.message||"Failed to load templates")}})(),()=>{a=!0}},[]);let u=async b=>{b.preventDefault(),l(!0);try{let b={name:q.name,status:"draft",messageTemplateId:q.messageTemplateId||null,schedule:q.schedule,settings:q.settings},c=await fetch("/api/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json().catch(()=>({}));if(!c.ok)throw Error(d?.error||`Failed to create campaign (HTTP ${c.status}).`);a.push("/campaigns")}catch(a){console.error("Failed to create campaign:",a),window.alert("Failed to create campaign")}finally{l(!1)}},v=(a,b)=>{r(c=>({...c,[a]:b}))},w=(a,b,c)=>{r(d=>({...d,[a]:{...d[a],[b]:c}}))},x=(a,b)=>{r(c=>({...c,schedule:{...c.schedule,dailyLimits:{...c.schedule.dailyLimits,[a]:b}}}))},y=async()=>{if(!q.leadsUrl&&!o)return void window.alert("Provide a Google Sheets URL or select a CSV file");n(!0);try{let a=[];if(q.leadsUrl){let b=await fetch("/api/leads/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:q.leadsUrl})}),c=await b.json().catch(()=>({}));if(!b.ok)throw Error(c?.error||`Import failed (HTTP ${b.status})`);a=Array.isArray(c?.usernames)?c.usernames:[]}if(o){let b=(await o.text()).split("\n").map(a=>a.trim()).filter(a=>a&&!a.toLowerCase().includes("username")).map(a=>a.replace(/^@/,"").trim()).filter(a=>/^[a-zA-Z0-9._]{1,30}$/.test(a));a=[...new Set([...a,...b])]}r(b=>({...b,settings:{...b.settings,leadUsernames:a}})),window.alert(`Imported ${a.length} usernames`)}catch(a){window.alert(a?.message||"Import failed")}finally{n(!1)}},z=async()=>{try{let a={...q,savedAt:new Date().toISOString()};localStorage.setItem("rebondir_campaign_draft",JSON.stringify(a)),window.alert("Draft saved")}catch(a){console.error("Failed to save draft:",a),window.alert("Failed to save draft")}};return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("nav",{className:"bg-white border-b border-gray-200",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(j.default,{href:"/",className:"flex items-center space-x-2",children:[(0,b.jsx)(e.MessageSquare,{className:"h-8 w-8 text-purple-600"}),(0,b.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:"Rebondir Studios"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,b.jsx)(j.default,{href:"/dashboard",className:"text-gray-600 hover:text-gray-900",children:"Dashboard"}),(0,b.jsx)(j.default,{href:"/campaigns",className:"text-purple-600 font-medium",children:"Campaigns"}),(0,b.jsx)(j.default,{href:"/accounts",className:"text-gray-600 hover:text-gray-900",children:"Accounts"}),(0,b.jsx)(j.default,{href:"/templates",className:"text-gray-600 hover:text-gray-900",children:"Templates"}),(0,b.jsx)(j.default,{href:"/analytics",className:"text-gray-600 hover:text-gray-900",children:"Analytics"})]})]})})}),(0,b.jsxs)("main",{className:"max-w-4xl mx-auto px-6 py-8",children:[(0,b.jsx)("div",{className:"flex items-center space-x-4 mb-8",children:(0,b.jsxs)(j.default,{href:"/campaigns",className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900",children:[(0,b.jsx)(f.ArrowLeft,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Back to Campaigns"})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Create New Campaign"}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Campaign Details"}),(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Campaign Name"}),(0,b.jsx)("input",{type:"text",value:q.name,onChange:a=>v("name",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"e.g. Summer Sale Outreach",required:!0})]})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Message Template"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Template"}),(0,b.jsxs)("select",{value:q.messageTemplateId,onChange:a=>v("messageTemplateId",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"",children:"Choose a template..."}),s.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),q.messageTemplateId&&(0,b.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 mb-2",children:"Template Preview:"}),(0,b.jsx)("p",{className:"text-gray-700",children:s.find(a=>a.id===q.messageTemplateId)?.content})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Leads Import"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Google Sheets URL"}),(0,b.jsx)("input",{type:"url",value:q.leadsUrl,onChange:a=>v("leadsUrl",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"https://docs.google.com/spreadsheets/d/..."})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsx)("button",{type:"button",onClick:y,className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",disabled:m||!q.leadsUrl&&!o,children:m?"Importing...":"Import"})})]}),(0,b.jsxs)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Or upload CSV file"}),(0,b.jsx)("input",{type:"file",accept:".csv",onChange:a=>p(a.target.files?.[0]||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsx)("div",{className:"flex items-end",children:o&&(0,b.jsx)("button",{type:"button",onClick:()=>p(null),className:"w-full px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Clear CSV"})})]}),q.settings?.leadUsernames?.length>0&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700",children:["Imported Usernames (",q.settings?.leadUsernames?.length,")"]}),(0,b.jsx)("button",{type:"button",onClick:()=>w("settings","leadUsernames",[]),className:"text-xs text-red-600 hover:text-red-700 transition-colors",children:"Delete All"})]}),(0,b.jsx)("div",{className:"border border-gray-300 rounded-lg p-3 bg-gray-50 min-h-[120px] max-h-[120px] overflow-y-auto",children:(0,b.jsx)("div",{className:"space-y-1",children:(q.settings?.leadUsernames||[]).map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-1 px-2 rounded hover:bg-gray-100 transition-colors",children:[(0,b.jsxs)("span",{className:"text-sm text-gray-900",children:["@",a]}),(0,b.jsx)("button",{type:"button",onClick:()=>{w("settings","leadUsernames",(q.settings?.leadUsernames||[]).filter(b=>b!==a))},className:"text-red-500 hover:text-red-700 transition-colors",title:"Delete username",children:(0,b.jsx)(i.Trash2,{className:"h-3 w-3"})})]},a))})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Schedule"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Type"}),(0,b.jsxs)("select",{value:q.schedule.type,onChange:a=>w("schedule","type",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"immediate",children:"Start Immediately"}),(0,b.jsx)("option",{value:"scheduled",children:"Schedule for Later"}),(0,b.jsx)("option",{value:"recurring",children:"Recurring Campaign"})]})]}),"immediate"!==q.schedule.type&&(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Date"}),(0,b.jsx)("input",{type:"datetime-local",value:q.schedule.startDate,onChange:a=>w("schedule","startDate",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),"scheduled"===q.schedule.type&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"End Date"}),(0,b.jsx)("input",{type:"datetime-local",value:q.schedule.endDate,onChange:a=>w("schedule","endDate",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium text-gray-900 mb-3",children:"Daily Limits"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Hour"}),(0,b.jsx)("input",{type:"number",min:"0",max:"23",value:q.schedule.dailyLimits.startHour,onChange:a=>x("startHour",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Hour"}),(0,b.jsx)("input",{type:"number",min:"0",max:"23",value:q.schedule.dailyLimits.endHour,onChange:a=>x("endHour",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Messages/Hour"}),(0,b.jsx)("input",{type:"number",min:"1",value:q.schedule.dailyLimits.messagesPerHour,onChange:a=>x("messagesPerHour",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Messages/Day"}),(0,b.jsx)("input",{type:"number",min:"1",value:q.schedule.dailyLimits.messagesPerDay,onChange:a=>x("messagesPerDay",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Campaign Settings"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Delay Between Messages (seconds)"}),(0,b.jsx)("input",{type:"number",min:"5",value:q.settings.delayBetweenMessages,onChange:a=>w("settings","delayBetweenMessages",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",checked:q.settings.useSpinText,onChange:a=>w("settings","useSpinText",a.target.checked),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Use spin text"})]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",checked:q.settings.randomizeMessageOrder,onChange:a=>w("settings","randomizeMessageOrder",a.target.checked),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Randomize message order"})]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"checkbox",checked:q.settings.skipAlreadyContacted,onChange:a=>w("settings","skipAlreadyContacted",a.target.checked),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Skip already contacted"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"flex items-center mb-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:q.settings.enableFollowUp,onChange:a=>w("settings","enableFollowUp",a.target.checked),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Enable follow-up messages"})]}),q.settings.enableFollowUp&&(0,b.jsxs)("div",{className:"ml-6 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"Follow-up delay (hours)"}),(0,b.jsx)("input",{type:"number",min:"1",value:q.settings.followUpDelay,onChange:a=>w("settings","followUpDelay",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm text-gray-700 mb-1",children:"Follow-up message"}),(0,b.jsx)("textarea",{rows:3,value:q.settings.followUpMessage,onChange:a=>w("settings","followUpMessage",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Enter your follow-up message..."})]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[(0,b.jsx)(j.default,{href:"/campaigns",className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsxs)("button",{type:"button",onClick:z,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 flex items-center space-x-2",children:[(0,b.jsx)(g.Save,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:"Save as Draft"})]}),(0,b.jsxs)("button",{type:"submit",disabled:k,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[(0,b.jsx)(h.Play,{className:"h-5 w-5"}),(0,b.jsx)("span",{children:k?"Creating...":"Create Campaign"})]})]})]})]})]})]})]})}a.s(["default",()=>k])}];

//# sourceMappingURL=instadm-clone_src_app_campaigns_new_page_tsx_8d4283c7._.js.map